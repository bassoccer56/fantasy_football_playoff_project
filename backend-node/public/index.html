<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fantasy Leaderboard</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #1a1a2e; color: white; text-align: center; margin: 0; padding: 20px; }
        h1 { color: #e94560; text-transform: uppercase; letter-spacing: 2px; }
        
        /* Flex container to show cards in a nice grid */
        #leaderboard { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin-top: 30px; }
        
        .card { 
            background: #16213e; 
            padding: 20px; 
            border-radius: 15px; 
            width: 250px; 
            border: 2px solid #0f3460;
            transition: transform 0.3s ease, border-color 0.3s ease;
            position: relative;
        }
        
        /* Highlight the #1 player */
        .card:first-child { border-color: #e94560; transform: scale(1.05); box-shadow: 0 0 15px rgba(233, 69, 96, 0.4); }
        .card:first-child::before { content: "üëë"; position: absolute; top: -15px; left: 50%; transform: translateX(-50%); font-size: 1.5rem; }

        .points { font-size: 2.5em; color: #e94560; font-weight: bold; margin: 10px 0; }
        .pos-tag { background: #0f3460; padding: 4px 10px; border-radius: 5px; font-size: 0.8em; text-transform: uppercase; }
        
        .status-bar { font-size: 0.8em; color: #4e4e6a; margin-top: 40px; }
    </style>
</head>
<body>
    <h1>üèÜ Playoff Leaderboard</h1>
    
    <div id="leaderboard">
        </div>

    <div class="status-bar">
        Auto-refreshing every 5 seconds...
    </div>

    <script>
        async function loadPlayers() {
            try {
                const response = await fetch('/players');
                const players = await response.json();
                
                // 1. Sort players by points (Descending: highest first)
                players.sort((a, b) => b.points - a.points);

                const container = document.getElementById('leaderboard');
                
                // 2. Map data to HTML
                container.innerHTML = players.map(p => `
                    <div class="card">
                        <span class="pos-tag">${p.position}</span>
                        <h2>${p.name}</h2>
                        <div class="points">${p.points}</div>
                        <p>Total Fantasy Points</p>
                    </div>
                `).join('');

                console.log("Leaderboard updated at: " + new Date().toLocaleTimeString());
            } catch (err) {
                console.error("Failed to fetch players:", err);
            }
        }

        // Initial load
        loadPlayers();

        // 3. Set Interval for Auto-Refresh (5000ms = 5 seconds)
        setInterval(loadPlayers, 5000);
    </script>
</body>
</html>